<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Notes - Chrome Built-in AI Test</title>

    <!-- Vue.js and Bootstrap Vue -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.23.1/dist/bootstrap-vue.min.js"></script>

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.23.1/dist/bootstrap-vue.min.css"
    />

    <!-- Custom styles for animations -->
    <style>
      .status-indicator {
        display: inline-block;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        margin-right: 0.75rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .status-available {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        animation: pulse 2s infinite;
      }
      .status-unavailable {
        background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
      }
      .status-checking {
        background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
        animation: pulse 1.5s infinite;
      }
      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
        100% {
          opacity: 1;
        }
      }
      .test-result {
        font-family: "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas,
          "Courier New", monospace;
        white-space: pre-wrap;
        overflow-x: auto;
      }
      .gradient-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }
      .performance-metrics {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      }
      .metric-value {
        font-size: 1.5rem;
        font-weight: bold;
        color: #667eea;
      }
      .metric-label {
        font-size: 0.875rem;
        color: #6c757d;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- Header Section -->
      <div class="jumbotron gradient-header text-white mb-4">
        <div class="container">
          <h1 class="display-4">ü§ñ AI Notes - Chrome Built-in AI Test Suite</h1>
          <p class="lead">
            Comprehensive testing environment for Chrome's AI APIs with enhanced
            performance monitoring and optimized session management.
          </p>
          <p class="mb-0">
            <strong>Status:</strong>
            <span class="badge" :class="initStatusClass"
              >{{ initStatusText }}</span
            >
          </p>
        </div>
      </div>

      <div class="container-fluid">
        <!-- Chrome AI Availability Check -->
        <b-card
          class="mb-4"
          border-variant="primary"
          header-bg-variant="primary"
          header-text-variant="white"
        >
          <template #header>
            <div class="d-flex align-items-center">
              <span class="status-indicator" :class="chromeAIStatus"></span>
              <h5 class="mb-0">Chrome AI Availability</h5>
            </div>
          </template>
          <p>
            Check if Chrome's built-in AI features are available and properly
            configured.
          </p>
          <b-button
            variant="primary"
            :disabled="isCheckingAvailability"
            @click="checkChromeAIAvailability"
          >
            {{ isCheckingAvailability ? 'Checking...' : 'Check Chrome AI
            Availability' }}
          </b-button>
          <b-alert
            :show="showAvailabilityResult"
            class="mt-3 test-result"
            :variant="availabilityResultType"
          >
            {{ availabilityResult }}
          </b-alert>
        </b-card>

        <!-- Performance Metrics -->
        <b-card
          class="mb-4"
          header-bg-variant="info"
          header-text-variant="white"
        >
          <template #header>
            <h5 class="mb-0">‚ö° Performance Metrics</h5>
          </template>
          <p>
            Monitor AI operation performance and session efficiency with
            real-time tracking.
          </p>
          <div class="performance-metrics p-3 rounded mb-3">
            <h6>Real-time Performance Dashboard</h6>
            <b-row class="metrics-grid">
              <b-col md="3" sm="6" class="mb-3">
                <div class="text-center">
                  <div class="metric-value">{{ sessionStatus }}</div>
                  <div class="metric-label">Session Status</div>
                </div>
              </b-col>
              <b-col md="3" sm="6" class="mb-3">
                <div class="text-center">
                  <div class="metric-value">{{ operationCount }}</div>
                  <div class="metric-label">Operations</div>
                </div>
              </b-col>
              <b-col md="3" sm="6" class="mb-3">
                <div class="text-center">
                  <div class="metric-value">{{ avgLatency }}</div>
                  <div class="metric-label">Avg Latency</div>
                </div>
              </b-col>
              <b-col md="3" sm="6" class="mb-3">
                <div class="text-center">
                  <div class="metric-value">{{ uptime }}</div>
                  <div class="metric-label">Uptime</div>
                </div>
              </b-col>
            </b-row>
          </div>
          <b-button variant="info" @click="showPerformanceMetrics"
            >Update Metrics</b-button
          >
          <b-button
            variant="outline-info"
            @click="resetPerformanceMetrics"
            class="ml-2"
            >Reset Metrics</b-button
          >
          <b-alert
            :show="showMetricsResult"
            class="mt-3 test-result"
            variant="success"
          >
            {{ metricsResult }}
          </b-alert>
        </b-card>

        <!-- Command Parsing Test -->
        <b-card
          class="mb-4"
          header-bg-variant="success"
          header-text-variant="white"
        >
          <template #header>
            <h5 class="mb-0">üé§ Command Parsing Test</h5>
          </template>
          <p>
            Test the voice command parsing functionality used for "Hey Notes"
            commands with enhanced error handling.
          </p>
          <b-form-input
            v-model="commandInput"
            placeholder="Enter a voice command (e.g., 'create a new note')"
            class="mb-3"
          ></b-form-input>
          <b-button
            variant="success"
            :disabled="isParsingCommand"
            @click="testCommandParsing"
          >
            {{ isParsingCommand ? 'Parsing...' : 'Parse Command' }}
          </b-button>
          <b-alert
            :show="showCommandResult"
            class="mt-3 test-result"
            :variant="commandResultType"
          >
            {{ commandResult }}
          </b-alert>
        </b-card>

        <!-- Sentiment Analysis Test -->
        <b-card
          class="mb-4"
          header-bg-variant="warning"
          header-text-variant="dark"
        >
          <template #header>
            <h5 class="mb-0">üòä Sentiment Analysis Test</h5>
          </template>
          <p>
            Test the sentiment analysis used for note mood detection with
            improved accuracy.
          </p>
          <b-form-textarea
            v-model="sentimentInput"
            rows="4"
            placeholder="Enter note text to analyze sentiment..."
            class="mb-3"
          ></b-form-textarea>
          <b-button
            variant="warning"
            :disabled="isAnalyzingSentiment"
            @click="testSentimentAnalysis"
          >
            {{ isAnalyzingSentiment ? 'Analyzing...' : 'Analyze Sentiment' }}
          </b-button>
          <b-alert
            :show="showSentimentResult"
            class="mt-3 test-result"
            :variant="sentimentResultType"
          >
            {{ sentimentResult }}
          </b-alert>
        </b-card>

        <!-- Topic Extraction Test -->
        <b-card
          class="mb-4"
          header-bg-variant="danger"
          header-text-variant="white"
        >
          <template #header>
            <h5 class="mb-0">üè∑Ô∏è Topic Extraction Test</h5>
          </template>
          <p>
            Test the topic extraction used for tagging notes with smart
            filtering.
          </p>
          <b-form-textarea
            v-model="topicInput"
            rows="4"
            placeholder="Enter note text to extract topics..."
            class="mb-3"
          ></b-form-textarea>
          <b-button
            variant="danger"
            :disabled="isExtractingTopics"
            @click="testTopicExtraction"
          >
            {{ isExtractingTopics ? 'Extracting...' : 'Extract Topics' }}
          </b-button>
          <b-alert
            :show="showTopicResult"
            class="mt-3 test-result"
            :variant="topicResultType"
          >
            {{ topicResult }}
          </b-alert>
        </b-card>

        <!-- Mood Insights Test -->
        <b-card
          class="mb-4"
          header-bg-variant="secondary"
          header-text-variant="white"
        >
          <template #header>
            <h5 class="mb-0">üìä Mood Insights Test</h5>
          </template>
          <p>
            Test the mood pattern analysis across multiple notes with advanced
            analytics.
          </p>

          <div id="moodEntries">
            <b-card
              v-for="(entry, index) in moodEntries"
              :key="index"
              class="mb-3"
              bg-variant="light"
            >
              <b-form-input
                v-model="entry.title"
                placeholder="Entry title"
                class="mb-2"
              ></b-form-input>
              <b-form-textarea
                v-model="entry.content"
                rows="2"
                placeholder="Entry content"
              ></b-form-textarea>
            </b-card>
          </div>

          <b-button variant="secondary" @click="addMoodEntry" class="mr-2"
            >Add Note</b-button
          >
          <b-button
            variant="outline-secondary"
            :disabled="isAnalyzingMood"
            @click="testMoodInsights"
          >
            {{ isAnalyzingMood ? 'Analyzing...' : 'Generate Mood Insights' }}
          </b-button>
          <b-alert
            :show="showMoodResult"
            class="mt-3 test-result"
            :variant="moodResultType"
          >
            {{ moodResult }}
          </b-alert>
        </b-card>
      </div>
    </div>

    <!-- Vue.js Application -->
    <script>
      // Import Bootstrap Vue icons (optional)
      Vue.use(BootstrapVue);
      Vue.use(BootstrapVueIcons);

      new Vue({
        el: "#app",
        data: {
          // Initialization
          initialized: false,

          // Chrome AI Status
          chromeAIStatus: "status-checking",

          // Performance Metrics
          sessionStatus: "Loading...",
          operationCount: 0,
          avgLatency: "0ms",
          uptime: "0.0s",

          // Form inputs
          commandInput: "create a new note",
          sentimentInput:
            "Today was an amazing day! I accomplished so much and felt really productive. Everything went smoothly and I'm excited about tomorrow.",
          topicInput:
            "I had a great workout at the gym today. Then I met with Sarah for coffee and we discussed our upcoming vacation to Japan. I also finished reading that book about productivity.",

          // Mood entries
          moodEntries: [
            {
              title: "Meeting Notes",
              content:
                "Meeting with Sarah at 3 PM to discuss project timeline and deliverables.",
            },
            {
              title: "Work Tasks",
              content:
                "Need to finish the quarterly report by Friday. Prioritize tasks and delegate where possible.",
            },
            {
              title: "Personal Reminders",
              content:
                "Remember to call mom this weekend and check on the garden plants.",
            },
          ],

          // Loading states
          isCheckingAvailability: false,
          isParsingCommand: false,
          isAnalyzingSentiment: false,
          isExtractingTopics: false,
          isAnalyzingMood: false,

          // Results and visibility
          availabilityResult: "",
          showAvailabilityResult: false,
          availabilityResultType: "success",

          commandResult: "",
          showCommandResult: false,
          commandResultType: "success",

          sentimentResult: "",
          showSentimentResult: false,
          sentimentResultType: "success",

          topicResult: "",
          showTopicResult: false,
          topicResultType: "success",

          moodResult: "",
          showMoodResult: false,
          moodResultType: "success",

          metricsResult: "",
          showMetricsResult: false,

          // Computed properties for status
          initStatusText: "Initializing...",
          initStatusClass: "badge-secondary",
        },

        computed: {
          // Dynamic status indicator classes
          chromeAIStatusClass() {
            return `status-indicator status-${this.chromeAIStatus}`;
          },
        },

        async created() {
          try {
            this.initialized = await this.initTestSuite();
            this.updateInitStatus();
            this.updatePerformanceDisplay();
          } catch (error) {
            console.error("Initialization error:", error);
            this.initStatusText = "Error";
            this.initStatusClass = "badge-danger";
          }
        },

        mounted() {
          // Auto-update performance metrics every 5 seconds
          this.performanceInterval = setInterval(() => {
            this.updatePerformanceDisplay();
          }, 5000);
        },

        beforeDestroy() {
          if (this.performanceInterval) {
            clearInterval(this.performanceInterval);
          }
          this.cleanupTestSuite();
        },

        methods: {
          updateInitStatus() {
            if (this.initialized) {
              this.initStatusText = "Ready";
              this.initStatusClass = "badge-success";
            } else {
              this.initStatusText = "AI Unavailable";
              this.initStatusClass = "badge-danger";
            }
          },

          async initTestSuite() {
            // Import and initialize test suite functions
            try {
              const module = await import("./js/test-suite.js");
              return await module.initTestSuite();
            } catch (error) {
              console.error("Failed to load test suite:", error);
              return false;
            }
          },

          cleanupTestSuite() {
            try {
              if (window.cleanupTestSuite) {
                window.cleanupTestSuite();
              }
            } catch (error) {
              console.warn("Cleanup error:", error);
            }
          },

          updatePerformanceDisplay() {
            try {
              const module = window.testSuiteModule;
              if (module && module.getPerformanceMetrics) {
                const metrics = module.getPerformanceMetrics();
                this.sessionStatus = metrics.sessionStatus;
                this.operationCount = metrics.operationCount;
                this.avgLatency = `${metrics.avgLatency}ms`;
                this.uptime = `${metrics.uptime}s`;
              }
            } catch (error) {
              console.warn("Performance update error:", error);
            }
          },

          async checkChromeAIAvailability() {
            this.isCheckingAvailability = true;

            try {
              const module = await import("./js/test-suite.js");
              const result = await module.checkChromeAIAvailability();

              this.chromeAIStatus = result.available
                ? "available"
                : "unavailable";
              this.availabilityResult = result.message;
              this.showAvailabilityResult = true;
              this.availabilityResultType = result.available
                ? "success"
                : "danger";
            } catch (error) {
              this.chromeAIStatus = "unavailable";
              this.availabilityResult = `‚ùå Error: ${error.message}`;
              this.showAvailabilityResult = true;
              this.availabilityResultType = "danger";
            }

            this.isCheckingAvailability = false;
          },

          async testCommandParsing() {
            this.isParsingCommand = true;

            try {
              const module = await import("./js/test-suite.js");
              const testResult = await module.testCommandParsing(
                this.commandInput
              );

              this.commandResult = testResult.message;
              this.showCommandResult = true;
              this.commandResultType = testResult.success
                ? "success"
                : "danger";
            } catch (error) {
              this.commandResult = `‚ùå Error: ${error.message}`;
              this.showCommandResult = true;
              this.commandResultType = "danger";
            }

            this.isParsingCommand = false;
          },

          async testSentimentAnalysis() {
            this.isAnalyzingSentiment = true;

            try {
              const module = await import("./js/test-suite.js");
              const testResult = await module.testSentimentAnalysis(
                this.sentimentInput
              );

              this.sentimentResult = testResult.message;
              this.showSentimentResult = true;
              this.sentimentResultType = testResult.success
                ? "success"
                : "danger";
            } catch (error) {
              this.sentimentResult = `‚ùå Error: ${error.message}`;
              this.showSentimentResult = true;
              this.sentimentResultType = "danger";
            }

            this.isAnalyzingSentiment = false;
          },

          async testTopicExtraction() {
            this.isExtractingTopics = true;

            try {
              const module = await import("./js/test-suite.js");
              const testResult = await module.testTopicExtraction(
                this.topicInput
              );

              this.topicResult = testResult.message;
              this.showTopicResult = true;
              this.topicResultType = testResult.success ? "success" : "danger";
            } catch (error) {
              this.topicResult = `‚ùå Error: ${error.message}`;
              this.showTopicResult = true;
              this.topicResultType = "danger";
            }

            this.isExtractingTopics = false;
          },

          addMoodEntry() {
            this.moodEntries.push({
              title: "New Note",
              content: "Enter note content here...",
            });
          },

          async testMoodInsights() {
            this.isAnalyzingMood = true;

            try {
              const module = await import("./js/test-suite.js");
              const testResult = await module.testMoodInsights(
                this.moodEntries
              );

              this.moodResult = testResult.message;
              this.showMoodResult = true;
              this.moodResultType = testResult.success ? "success" : "danger";
            } catch (error) {
              this.moodResult = `‚ùå Error: ${error.message}`;
              this.showMoodResult = true;
              this.moodResultType = "danger";
            }

            this.isAnalyzingMood = false;
          },

          showPerformanceMetrics() {
            this.updatePerformanceDisplay();

            try {
              const module = window.testSuiteModule;
              if (module && module.getPerformanceMetrics) {
                const metrics = module.getPerformanceMetrics();
                this.metricsResult = `üìä Performance Metrics\n\nSession Status: ${metrics.sessionStatus}\nTotal Operations: ${metrics.operationCount}\nAverage Latency: ${metrics.avgLatency}ms\nTotal Test Time: ${metrics.uptime}s`;
                this.showMetricsResult = true;
              }
            } catch (error) {
              this.metricsResult = `‚ùå Error getting metrics: ${error.message}`;
              this.showMetricsResult = true;
            }
          },

          resetPerformanceMetrics() {
            try {
              const module = window.testSuiteModule;
              if (module && module.resetPerformanceMetrics) {
                module.resetPerformanceMetrics();
                this.updatePerformanceDisplay();
                this.metricsResult = "‚úÖ Performance metrics reset";
                this.showMetricsResult = true;
              }
            } catch (error) {
              this.metricsResult = `‚ùå Error resetting metrics: ${error.message}`;
              this.showMetricsResult = true;
            }
          },
        },
      });
    </script>
  </body>
</html>
